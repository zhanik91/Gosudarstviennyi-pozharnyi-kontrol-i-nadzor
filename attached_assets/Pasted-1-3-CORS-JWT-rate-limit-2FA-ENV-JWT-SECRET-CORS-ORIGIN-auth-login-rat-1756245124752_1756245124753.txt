1.3 CORS/JWT/rate-limit/2FA
	•	ENV: требовать JWT_SECRET, CORS_ORIGIN.
	•	/auth/login — добавить rate-limit (например express-rate-limit: 10 попыток/5 мин/IP).
	•	2FA (TOTP): таблица user_totp с secret, enabled; эндпоинты: POST /auth/enable-2fa (выдаёт otpauth:// QR), POST /auth/verify-2fa (проверка кода), при авторизации — если включено, требовать TOTP.

⸻

2) Инциденты: добавить редактирование
	•	PUT /api/incidents/:id (полное/частичное обновление по типу события, с повторной валидацией).
	•	В UI журнала — кнопка «Редактировать», открывать «единое окно» с заполненными полями, сохранять PUT.

⸻

3) Полные справочники (строго по приказу)

Заменить data/enums на полные JSON:
	•	3-SPVP_causes.json — древо причин с подкатегориями.
	•	4-SOVP_objects.json — древо объектов и подтипов.
	•	5-SPZHS_* — соцположение, условия, места, дни недели, интервалы времени суток, этажность, типы ЖС и пр.
	•	2-SSG_cases.json — пункты 1–11 для «случаев горения».
	•	6-SSPZ_metrics.json — набор показателей для степи.

Формат элемента: { "code": "3.1.2", "label": "Перегрузка электропроводки", "parent": "3.1" }.
UI: древовидные селекты (в 5-СПЖС — мультиселекты).

(Если точный перечень сейчас недоступен — временно заполнить максимально близко и пометить TODO, но архитектуру и агрегации реализовать сразу.)

⸻

4) Пакеты: консолидация родителя

Добавить:
	•	POST /api/packages/consolidate — у области/РК собирает сводный пакет из утверждённых пакетов детей за период, фиксирует snapshot, статус consolidated.
	•	Кнопку «Сформировать сводный» на уровне области/РК.
	•	Возврат/утверждение — письмо (см. п.7).

⸻

5) Валидации — список в UI

API уже есть. В разделе «Отчёты»:
	•	Показать таблицу ошибок (форма/раздел/строка, описание, кол-во случаев).
	•	По клику — фильтровать журнал инцидентов источников (период + orgId).
	•	Валидации включают:
	•	1-ОСП: всего = город + село, «дети/нетрезвые ≤ всего», деньги округлять 0,1 тыс. тг.
	•	3/4: всего ≥ в т.ч. ОВСР.
	•	5-СПЖС: итоги разделов = сумма подпунктов.
	•	6-ССПЗ: пострадавшие = погибло + травмировано (люди/животные отдельно); «ликвидировано без Службы ПАСР» учитывать отдельно.

⸻

6) Печатные формы (все 7)

Сверстать EJS-макеты c единым стилем и подписью «Исполнитель/Руководитель/Дата/М.П.»:
	•	1-ОСП (всего/город/село; деньги — именно 0,1).
	•	2-ССГ (пункты 1–11).
	•	3-СПВП, 4-СОВП (строго по справочникам; столбцы «в т.ч. ОВСР»).
	•	5-СПЖС (все блоки наборов).
	•	6-ССПЗ: Таблица 1 (пожары) и Таблица 2 (загорания).
	•	CO-форма (отравления без пожара; суммы идут в 1-ОСП строки 4/6).

Для каждой — кнопки «Печать» и «Экспорт XLSX» (см. п.8).

⸻

7) Email-уведомления
	•	Подключить nodemailer, ENV: SMTP_HOST, SMTP_USER, SMTP_PASS, SMTP_FROM.
	•	События PACKAGE_RETURN, PACKAGE_APPROVE → письмо ответственному пользователя орг-уровня (почта у user); в dev — лог в консоль.

⸻

8) Экспорт/импорт
	•	GET /api/export/report?form=...&period=YYYY-MM&orgId=...&includeChildren=... → XLSX с теми же данными, что печать (sheet по форме).
	•	POST /api/import/incidents (XLSX/CSV, multipart) — dry-run: показываем ошибки; по подтверждению — коммит.
	•	Шаблоны для импорта положить в /public/templates.

⸻

9) Диаграммы (Chart.js)

Вкладка «Диаграммы»:
	•	Линия «Динамика пожаров по месяцам».
	•	Круг «Причины (3-СПВП)».
	•	Горизонтальная гистограмма «Объекты (4-СОВП)».
	•	Теплокарта по детям выбранной орг.
Экспорт PNG; сохранение пресетов (LocalStorage).

⸻

10) Админка
	•	Дерево организаций (РК → области → районы) — CRUD (включая новые области: Абай, Жетісу, Ұлытау).
	•	Пользователи — CRUD, роли, орг-привязка, включение/подтверждение 2FA.
	•	Журнал Audit — таблица, фильтры, экспорт CSV.
	•	(Опционально) Импорт JSON-справочников в /data/enums.

⸻

11) Postgres-адаптер (опционально)

Слой репозиториев в /data/repo/* сделать интерфейсным. Если задан DB_URL → использовать pg, создать таблицы миграцией. По умолчанию — файловая БД.

⸻

12) ENV и приёмочные тесты