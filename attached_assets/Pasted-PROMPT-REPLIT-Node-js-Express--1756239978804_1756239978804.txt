PROMPT ДЛЯ REPLIT-АГЕНТА

Цель. Обновить проект «Госучет пожаров РК» (Node.js/Express, фронт на чистом HTML/JS) до версии v2.0, чтобы он соответствовал приказу МЧС: «одно окно» ввода, автоматическое распределение по формам 1-ОСП, 2-ССГ, 3-СПВП, 4-СОВП, 5-СПЖС, 6-ССПЗ и форме по СО, печать форм, диаграммы, иерархическая отправка «район → область → РК».

Что сделать по шагам

Перезаписать файлы ниже точь-в-точь содержимым из раздела «ФАЙЛЫ» этой инструкции (создать каталоги, если их нет):

package.json

server.js

public/index.html, public/assets/styles.css, public/assets/app.js

views/forms/1-osp.ejs, 2-ssg.ejs, 3-spvp.ejs, 4-sovp.ejs, 5-spzhs.ejs, 6-sspz.ejs, co.ejs

data/enums/*.json

data/seed_orgs_users.json

README.md

Зависимости установить командой npm i.

Секреты (Replit Secrets):

JWT_SECRET — сгенерировать случайным,

(опц.) ADMIN_PASSWORD — пароль админа (по умолчанию admin123).

Запуск. Команда npm start. Открыть главную страницу, войти как admin@example.com / пароль (из ADMIN_PASSWORD).

Проверки (acceptance):

Вкладки: Журнал / Отчеты / Диаграммы / Пакеты / Админ — видны, роль admin.

В журнале: создать «Пожар» с причиной и объектом — в «Отчеты» 1-ОСП/3-СПВП/4-СОВП появляются соответствующие строки; флажок «Жилой сектор» открывает множественные выборы и отражается в 5-СПЖС.

«Случай горения (не пожар)» попадает в 2-ССГ.

«Степной пожар/загорание» попадает в 6-ССПЗ; steppe_fire также учитывается как пожар для 1/3/4.

Печать форм: кнопки открывают /forms/* с таблицами и авто-печатью.

Валидация возвращает детальные ошибки (балансы/ОВСР/дети).

Пакеты: «Отправить вверх» создаёт пакет, «Сводный» у родителя собирает детей; входящие видны, работают «Утвердить/Возврат».

Безопасность: запросы /api/reports?orgId=… и /forms/*?orgId=… выдают 403, если orgId не в дереве текущего пользователя; includeChildren=true доступен только reviewer/approver/admin.

Справочники 3/4/5 форм. В data/enums/* уже положены структуры. При наличии официальных Excel/Word — заполнить полными иерархиями (точные формулировки приказа). Пока можно оставить поставленные значения — интерфейс и агрегаторы уже работают.